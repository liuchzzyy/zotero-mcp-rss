# ==============================================================================
# Zotero MCP Configuration Template
# ==============================================================================
#
# This is the configuration template for Zotero MCP.
# Copy this file to .env and fill in your actual values.
#
# Configuration Priority:
#   1. Environment variables (highest priority)
#   2. Standalone config (~/.config/zotero-mcp/config.json)
#   3. Opencode CLI config (lowest priority)
#
# Environment Modes:
#   - development: Local mode with debug logging
#   - testing: Local mode with info logging
#   - production: Remote mode with warning logging
#
# ==============================================================================

# ------------------------------------------------------------------------------
# ENVIRONMENT MODE
# ------------------------------------------------------------------------------
# Options: development, testing, production
# Default: production
#
# - development: Enable local Zotero API, debug logging, verbose output
# - testing: Enable local Zotero API, info logging
# - production: Use Zotero Web API, warning logging (recommended for GitHub Actions)
ENV_MODE = production

# ------------------------------------------------------------------------------
# ZOTERO API CONFIGURATION
# ------------------------------------------------------------------------------
# Get your API key from: https://www.zotero.org/settings/keys
#
# Required: Yes
ZOTERO_LIBRARY_ID = your_library_id_here
ZOTERO_API_KEY = your_api_key_here

# Library type (user or group)
# Default: user
ZOTERO_LIBRARY_TYPE = user

# ------------------------------------------------------------------------------
# ZOTERO ACCESS MODE
# ------------------------------------------------------------------------------
# Local vs Web API
# - true: Use local Zotero SQLite database (faster, direct PDF access)
# - false: Use Zotero Web API (slower, rate-limited, required for GitHub Actions)
# Default: determined by ENV_MODE (true for dev/testing, false for production)
# ZOTERO_LOCAL=false

# ------------------------------------------------------------------------------
# METADATA API (CROSSREF & OPENALEX)
# ------------------------------------------------------------------------------
# Shared email for polite pool access (used by both CrossRef and OpenAlex)
# POLITE_POOL_EMAIL=your_email@example.com
#
# Shared timeout in seconds (default: 45)
# API_TIMEOUT=45
#
# ---- OpenAlex ----
# OPENALEX_EMAIL=your_email@example.com
# OPENALEX_API_KEY=your_openalex_api_key_here
# OPENALEX_API_BASE=https://api.openalex.org
# OPENALEX_TIMEOUT=45
# OPENALEX_USER_AGENT=
# OPENALEX_MAX_REQUESTS_PER_SECOND=10

# ------------------------------------------------------------------------------
# AI/LLM CONFIGURATION
# ------------------------------------------------------------------------------
# DeepSeek API for paper analysis
# Get key from: https://platform.deepseek.com/
# Required: Yes
DEEPSEEK_API_KEY = your_deepseek_api_key_here
DEEPSEEK_BASE_URL = your_deepseek_base_url_here  # Default: https://api.deepseek.com
DEEPSEEK_MODEL = your_deepseek_model_here  # Options: deepseek-chat, deepseek-v3

# Claude CLI Configuration (uses local claude command for analysis)
# Requires Claude Code CLI installed: npm install -g @anthropic-ai/claude-code
# Use llm_provider="claude-cli" in batch_analyze to activate
# CLI_LLM_COMMAND=claude          # CLI command name (default: claude)
# CLI_LLM_TIMEOUT=300             # Timeout in seconds (default: 300)

# Multi-Modal LLM Configuration
# These settings are used for CLI-based PDF analysis
# Supported providers: deepseek, openai, gemini, claude
#
# CLI LLM Provider Configuration
# ZOTERO_MCP_CLI_LLM_PROVIDER=deepseek      # Choose your LLM provider
# ZOTERO_MCP_CLI_LLM_MODEL=deepseek-chat    # Model to use (provider-specific)
# ZOTERO_MCP_CLI_LLM_API_KEY=your_key       # API key for the provider
#
# OCR Configuration (for text extraction from images)
# ZOTERO_MCP_CLI_LLM_OCR_ENABLED=true        # Enable OCR mode
# ZOTERO_MCP_CLI_LLM_OCR_LANGUAGES=zh,en   # Languages for OCR (comma-separated)
# ZOTERO_MCP_CLI_LLM_OCR_ENGINE=tesseract    # OCR engine (tesseract, default)
#
# Analysis Parameters
# ZOTERO_MCP_CLI_LLM_MAX_PAGES=50            # Maximum pages to process per PDF
# ZOTERO_MCP_CLI_LLM_MAX_IMAGES=20           # Maximum images to extract
# ZOTERO_MCP_CLI_LLM_CHUNK_SIZE=2000         # Text chunk size for processing
# ZOTERO_MCP_CLI_LLM_MAX_RETRIES=5          # Maximum retry attempts for API calls
# ZOTERO_MCP_CLI_LLM_TIMEOUT=300             # API timeout in seconds
#
# Output Settings
# ZOTERO_MCP_CLI_LLM_OUTPUT_FORMAT=markdown  # Output format: markdown, json
# ZOTERO_MCP_CLI_LLM_SAVE_SUMMARY=true       # Save summary to file
# ZOTERO_MCP_CLI_LLM_OUTPUT_DIR=./summaries  # Directory for output files

# ------------------------------------------------------------------------------
# AI ANALYSIS CONFIGURATION
# ------------------------------------------------------------------------------
# Analysis questions (JSON array or newline-separated)
# Default questions are used if not specified
# ANALYSIS_QUESTIONS='["问题1?", "问题2?"]'

# Custom analysis template (overrides default template)
# ANALYSIS_TEMPLATE="Your custom template here with {title}, {authors}, {fulltext}, etc."

# Note theme: orange-heart, default, minimal
# NOTE_THEME=orange-heart

# Custom theme configuration (JSON format, overrides preset)
# NOTE_THEME_CONFIG='{"primary_color": "rgb(239, 112, 96)", "paragraph_margin": "0.5em"}'

# ------------------------------------------------------------------------------
# SEMANTIC SEARCH CONFIGURATION
# ------------------------------------------------------------------------------
# Embedding model: default, openai, gemini
# Default: default (uses local embeddings)
ZOTERO_EMBEDDING_MODEL = default

# For OpenAI embeddings (if ZOTERO_EMBEDDING_MODEL=openai)
# OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# For Gemini embeddings (if ZOTERO_EMBEDDING_MODEL=gemini)
# GEMINI_EMBEDDING_MODEL=models/text-embedding-004

# PDF extraction limits (optional)
# ZOTERO_PDF_MAXPAGES=100


# ------------------------------------------------------------------------------
# WORKFLOW DEFAULTS
# ------------------------------------------------------------------------------
# Collections for analysis workflows
SOURCE_COLLECTION_NAME = your_source_collection_name_here
DEST_COLLECTION_NAME = your_dest_collection_name_here
EXCLUDED_COLLECTION_NAME = your_excluded_collection_name_here

# Tag added after successful analysis
TAG_TO_ADD = your_tag_here

# ------------------------------------------------------------------------------
# ADVANCED CONFIGURATION
# ------------------------------------------------------------------------------
# Custom Zotero database path (optional)
# ZOTERO_DB_PATH=/path/to/zotero.sqlite

# ------------------------------------------------------------------------------
# PDF & Supporting Info Lookup
# ------------------------------------------------------------------------------
# Sci-Hub base URL (optional, used by zotero_find_pdf_si tools)
# ZOTERO_SCIHUB_BASE_URL=https://sci-hub.se
#
# Supporting info keywords (comma-separated or JSON list)
# ZOTERO_PDF_SI_KEYWORDS=supplement,supplementary,supporting information,appendix
#
# Supporting info extensions (comma-separated or JSON list)
# ZOTERO_PDF_SI_EXTENSIONS=.pdf,.zip,.csv,.xlsx,.docx
#
# Optional download directory for fetched PDFs/SI
# If set, downloaded files are kept here.
# ZOTERO_PDF_DOWNLOAD_DIR=./downloads

# Download settings
# ZOTERO_PDF_DOWNLOAD_TIMEOUT=60
# ZOTERO_PDF_DOWNLOAD_RETRIES=2
# ZOTERO_PDF_DOWNLOAD_RETRY_BACKOFF=1.5
# ZOTERO_PDF_PROXY=http://127.0.0.1:7890

# Debug logging (override ENV_MODE setting)
# DEBUG=true

# Log level (override ENV_MODE setting)
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
# LOG_LEVEL=INFO

# ------------------------------------------------------------------------------
# CONFIGURATION NOTES
# ------------------------------------------------------------------------------
#
# 1. Security Best Practices:
#    - Never commit .env file to version control
#    - Use different API keys for development and production
#    - Rotate API keys regularly
#    - Use environment-specific values when possible
#
# 2. LLM Provider:
#    - This project uses DeepSeek API for paper analysis
#    - DeepSeek is cost-effective and provides good quality analysis
#
# 3. Environment Mode Usage:
#    - Development: Use ENV_MODE=development for local development
#    - Testing: Use ENV_MODE=testing for CI/CD pipelines
#    - Production: Use ENV_MODE=production for deployed instances
#
# 3. Configuration Validation:
#    - Run `zotero-mcp setup-info` to verify your configuration
#    - Check that all required API keys are set
#    - Verify Zotero connection before running workflows
#
# 4. Performance Tuning:
#    - Use local mode (ZOTERO_LOCAL=true) for faster PDF access
#    - Adjust ZOTERO_PDF_MAXPAGES based on your needs
#    - Use DeepSeek for cost-effective batch processing
#
# 5. Logging Configuration:
#    - Logs are stored in ~/.cache/zotero-mcp/logs/
#    - Log files are rotated daily and retained for 3 days
#    - GitHub Actions uploads logs as artifacts (also retained for 3 days)
#    - Use LOG_LEVEL to control verbosity (DEBUG, INFO, WARNING, ERROR)
#    - Enable DEBUG mode for troubleshooting issues
#
# ------------------------------------------------------------------------------

# LOGGING AND MONITORING
# ------------------------------------------------------------------------------
# Log level controls verbosity of logging output
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Default: INFO (or DEBUG if ENV_MODE=development/testing)
# LOG_LEVEL=INFO

# Debug mode enables verbose logging for troubleshooting
# Options: true, false
# Default: determined by ENV_MODE
# DEBUG=true

# Log directory location (optional)
# Default: ~/.cache/zotero-mcp/logs/
# ZOTERO_LOG_DIR=/path/to/logs

# Log retention period in days (optional)
# Default: 3 days
# ZOTERO_LOG_RETENTION_DAYS=3

# Enable file logging (optional)
# Options: true, false
# Default: true
# ZOTERO_LOG_TO_FILE=true

# Enable console logging (optional)
# Options: true, false
# Default: true
# ZOTERO_LOG_TO_CONSOLE=true

# ------------------------------------------------------------------------------
# LOGGING NOTES
# ------------------------------------------------------------------------------
#
# Log Levels Explained:
# - DEBUG: Detailed information for diagnosing problems
# - INFO: General information about task progress
# - WARNING: Warning messages for potential issues
# - ERROR: Error messages for failures
# - CRITICAL: Critical errors that stop execution
#
# GitHub Actions Logging:
# - All task logs are uploaded as artifacts
# - Logs include: task start/end time, items processed, errors
# - Logs are retained for 3 days then automatically deleted
# - Use GitHub Actions UI to download logs for analysis
#
# Performance Monitoring:
# - Task execution time is automatically logged
# - API call performance is tracked
# - Item processing progress is reported
#
# Troubleshooting:
# - Enable DEBUG mode to see detailed execution logs
# - Check ~/.cache/zotero-mcp/logs/ for historical logs
# - Use GitHub Actions artifacts to debug CI/CD failures
#
# ------------------------------------------------------------------------------
